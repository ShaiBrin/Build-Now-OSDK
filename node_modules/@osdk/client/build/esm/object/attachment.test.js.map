{"version":3,"file":"attachment.test.js","names":["$ontologyRid","objectTypeWithAllPropertyTypes","apiServer","stubData","afterAll","beforeAll","describe","expect","it","createClient","client","listen","close","result","where","id","objectWithAllPropertyTypes1","fetchPage","object1","data","attachment","toBeDefined","attachmentMetadata","fetchMetadata","filename","toEqual","mediaType","sizeBytes","rid","attachmentContent","fetchContents","attachmentText","text","JSON","parse","name"],"sources":["attachment.test.js"],"sourcesContent":["/*\n * Copyright 2024 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { $ontologyRid, objectTypeWithAllPropertyTypes, } from \"@osdk/client.test.ontology\";\nimport { apiServer, stubData } from \"@osdk/shared.test\";\nimport { afterAll, beforeAll, describe, expect, it } from \"vitest\";\nimport { createClient } from \"../createClient.js\";\ndescribe(\"attachments\", () => {\n    let client;\n    beforeAll(async () => {\n        apiServer.listen();\n        client = createClient(\"https://stack.palantir.com\", $ontologyRid, async () => \"myAccessToken\");\n    });\n    afterAll(() => {\n        apiServer.close();\n    });\n    it(\"reads attachment metadata successfully\", async () => {\n        const result = await client(objectTypeWithAllPropertyTypes)\n            .where({ id: stubData.objectWithAllPropertyTypes1.id }).fetchPage();\n        const object1 = result.data[0];\n        expect(object1.attachment).toBeDefined();\n        const attachmentMetadata = await object1.attachment?.fetchMetadata();\n        expect(attachmentMetadata).toBeDefined();\n        expect(attachmentMetadata?.filename).toEqual(\"file1.txt\");\n        expect(attachmentMetadata?.mediaType).toEqual(\"application/json\");\n        expect(attachmentMetadata?.sizeBytes).toEqual(18);\n        expect(attachmentMetadata?.rid).toEqual(\"ri.attachments.main.attachment.86016861-707f-4292-b258-6a7108915a75\");\n    });\n    it(\"reads attachment successfully\", async () => {\n        const result = await client(objectTypeWithAllPropertyTypes)\n            .where({ id: stubData.objectWithAllPropertyTypes1.id }).fetchPage();\n        const object1 = result.data[0];\n        expect(object1.attachment).toBeDefined();\n        const attachmentContent = await object1?.attachment?.fetchContents();\n        const attachmentText = await attachmentContent.text();\n        expect(JSON.parse(attachmentText)).toEqual({\n            name: \"Hello World 2\",\n        });\n    });\n});\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,YAAY,EAAEC,8BAA8B,QAAS,4BAA4B;AAC1F,SAASC,SAAS,EAAEC,QAAQ,QAAQ,mBAAmB;AACvD,SAASC,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,EAAE,QAAQ,QAAQ;AAClE,SAASC,YAAY,QAAQ,oBAAoB;AACjDH,QAAQ,CAAC,aAAa,EAAE,MAAM;EAC1B,IAAII,MAAM;EACVL,SAAS,CAAC,YAAY;IAClBH,SAAS,CAACS,MAAM,CAAC,CAAC;IAClBD,MAAM,GAAGD,YAAY,CAAC,4BAA4B,EAAET,YAAY,EAAE,YAAY,eAAe,CAAC;EAClG,CAAC,CAAC;EACFI,QAAQ,CAAC,MAAM;IACXF,SAAS,CAACU,KAAK,CAAC,CAAC;EACrB,CAAC,CAAC;EACFJ,EAAE,CAAC,wCAAwC,EAAE,YAAY;IACrD,MAAMK,MAAM,GAAG,MAAMH,MAAM,CAACT,8BAA8B,CAAC,CACtDa,KAAK,CAAC;MAAEC,EAAE,EAAEZ,QAAQ,CAACa,2BAA2B,CAACD;IAAG,CAAC,CAAC,CAACE,SAAS,CAAC,CAAC;IACvE,MAAMC,OAAO,GAAGL,MAAM,CAACM,IAAI,CAAC,CAAC,CAAC;IAC9BZ,MAAM,CAACW,OAAO,CAACE,UAAU,CAAC,CAACC,WAAW,CAAC,CAAC;IACxC,MAAMC,kBAAkB,GAAG,MAAMJ,OAAO,CAACE,UAAU,EAAEG,aAAa,CAAC,CAAC;IACpEhB,MAAM,CAACe,kBAAkB,CAAC,CAACD,WAAW,CAAC,CAAC;IACxCd,MAAM,CAACe,kBAAkB,EAAEE,QAAQ,CAAC,CAACC,OAAO,CAAC,WAAW,CAAC;IACzDlB,MAAM,CAACe,kBAAkB,EAAEI,SAAS,CAAC,CAACD,OAAO,CAAC,kBAAkB,CAAC;IACjElB,MAAM,CAACe,kBAAkB,EAAEK,SAAS,CAAC,CAACF,OAAO,CAAC,EAAE,CAAC;IACjDlB,MAAM,CAACe,kBAAkB,EAAEM,GAAG,CAAC,CAACH,OAAO,CAAC,qEAAqE,CAAC;EAClH,CAAC,CAAC;EACFjB,EAAE,CAAC,+BAA+B,EAAE,YAAY;IAC5C,MAAMK,MAAM,GAAG,MAAMH,MAAM,CAACT,8BAA8B,CAAC,CACtDa,KAAK,CAAC;MAAEC,EAAE,EAAEZ,QAAQ,CAACa,2BAA2B,CAACD;IAAG,CAAC,CAAC,CAACE,SAAS,CAAC,CAAC;IACvE,MAAMC,OAAO,GAAGL,MAAM,CAACM,IAAI,CAAC,CAAC,CAAC;IAC9BZ,MAAM,CAACW,OAAO,CAACE,UAAU,CAAC,CAACC,WAAW,CAAC,CAAC;IACxC,MAAMQ,iBAAiB,GAAG,MAAMX,OAAO,EAAEE,UAAU,EAAEU,aAAa,CAAC,CAAC;IACpE,MAAMC,cAAc,GAAG,MAAMF,iBAAiB,CAACG,IAAI,CAAC,CAAC;IACrDzB,MAAM,CAAC0B,IAAI,CAACC,KAAK,CAACH,cAAc,CAAC,CAAC,CAACN,OAAO,CAAC;MACvCU,IAAI,EAAE;IACV,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC","ignoreList":[]}