{"version":3,"file":"modernToLegacyAggregationClause.js","names":["directionFieldMap","dir","undefined","modernToLegacyAggregationClause","select","Object","entries","flatMap","propAndMetric","aggregationType","type","name","direction","colonPos","lastIndexOf","property","slice","metric","field"],"sources":["modernToLegacyAggregationClause.js"],"sourcesContent":["/*\n * Copyright 2023 Palantir Technologies, Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst directionFieldMap = (dir) => dir === \"asc\" ? \"ASC\" : dir === \"desc\" ? \"DESC\" : undefined;\n/** @internal */\nexport function modernToLegacyAggregationClause(select) {\n    return Object.entries(select).flatMap(([propAndMetric, aggregationType]) => {\n        if (propAndMetric === \"$count\") {\n            return {\n                type: \"count\",\n                name: \"count\",\n                direction: directionFieldMap(aggregationType),\n            };\n        }\n        const colonPos = propAndMetric.lastIndexOf(\":\");\n        const property = propAndMetric.slice(0, colonPos);\n        const metric = propAndMetric.slice(colonPos + 1);\n        return [\n            {\n                type: metric,\n                name: `${property}.${metric}`,\n                direction: directionFieldMap(aggregationType),\n                field: property,\n            },\n        ];\n    });\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,iBAAiB,GAAIC,GAAG,IAAKA,GAAG,KAAK,KAAK,GAAG,KAAK,GAAGA,GAAG,KAAK,MAAM,GAAG,MAAM,GAAGC,SAAS;AAC9F;AACA,OAAO,SAASC,+BAA+BA,CAACC,MAAM,EAAE;EACpD,OAAOC,MAAM,CAACC,OAAO,CAACF,MAAM,CAAC,CAACG,OAAO,CAAC,CAAC,CAACC,aAAa,EAAEC,eAAe,CAAC,KAAK;IACxE,IAAID,aAAa,KAAK,QAAQ,EAAE;MAC5B,OAAO;QACHE,IAAI,EAAE,OAAO;QACbC,IAAI,EAAE,OAAO;QACbC,SAAS,EAAEZ,iBAAiB,CAACS,eAAe;MAChD,CAAC;IACL;IACA,MAAMI,QAAQ,GAAGL,aAAa,CAACM,WAAW,CAAC,GAAG,CAAC;IAC/C,MAAMC,QAAQ,GAAGP,aAAa,CAACQ,KAAK,CAAC,CAAC,EAAEH,QAAQ,CAAC;IACjD,MAAMI,MAAM,GAAGT,aAAa,CAACQ,KAAK,CAACH,QAAQ,GAAG,CAAC,CAAC;IAChD,OAAO,CACH;MACIH,IAAI,EAAEO,MAAM;MACZN,IAAI,EAAE,GAAGI,QAAQ,IAAIE,MAAM,EAAE;MAC7BL,SAAS,EAAEZ,iBAAiB,CAACS,eAAe,CAAC;MAC7CS,KAAK,EAAEH;IACX,CAAC,CACJ;EACL,CAAC,CAAC;AACN","ignoreList":[]}